# HIDA Explorer：LTM/STM付き予測誤差検出エージェント

## 概要

前方1マスしか見えないエージェントが、**主観的な内部マップ**を構築しながら探索。
複数の部屋を移動しながら、長期記憶（LTM）と短期記憶（STM）を使い分ける。

## LTM/STM（長期記憶/短期記憶）

```
部屋A探索中:
  STM = 部屋Aのマップ（作業用）

「部屋Bに行け」:
  1. STM → LTMに保存（部屋Aの記憶を長期化）
  2. LTMから部屋Bを検索
  3. あれば → STMに読み込む
     なければ → STM空で開始

部屋Aに戻る:
  1. STM → LTMに保存（部屋Bの記憶を長期化）
  2. LTMから部屋Aを検索
  3. LTM → STMに読み込む
  4. 探索開始 → 壁が動いてたら予測誤差！
  5. STM更新
  6. 部屋を出る → 更新されたSTMをLTMに保存
```

人間と同じ:
```
「あの店どこだっけ...」→ LTMから検索
「あ、思い出した」→ STMに読み込み
「あれ？内装変わってる」→ 予測誤差
「こうなったのか」→ STM更新 → 後でLTMに反映
```

## 探索の仕組み

```
1マス移動
  ↓
look_around_and_remember()
  ↓
4方向（N, E, S, W）を見る（首振り）
  ↓
各方向のマスを記憶
  ↓
予測誤差チェック（記憶 vs 現実）
  ↓
次の未探索マスへBFSで移動
```

## ミッションの流れ

```
Phase 1: 部屋Aでボール→ゴール
  - STMにマップ構築
  - ボール発見→つかむ
  - ゴール発見→届ける

Phase 2: 部屋Bでボール→ゴール
  - 部屋AのSTM→LTMに保存
  - 部屋B初めて→STM空で開始
  - 同じようにミッション完了

Phase 3: 部屋Aに戻る
  - 部屋BのSTM→LTMに保存
  - LTMから部屋Aの記憶→STMへ
  - 「覚えてる」状態で探索
  - 壁が変わってたら予測誤差！
```

## 実行結果の例

```
Phase 1: 部屋Aでボール→ゴール
  💭 「部屋A...初めて来た」
  🎉 ボール発見！つかんだ
  🎯 ゴール到達！
結果: mission_complete

Phase 2: 部屋Bでボール→ゴール
  💾 部屋Aの記憶を保存（32マス）
  💭 「部屋B...初めて来た」
  🎉 ボール発見！つかんだ
  🎯 ゴール到達！
結果: mission_complete

Phase 3: 部屋Aに戻る（壁が動いてる）
  💾 部屋Bの記憶を保存（32マス）
  💭 「部屋A...覚えてる」
  ⚡ 予測誤差 @ (5, 3)
  💭 「おっ！何かある！」
結果: explored
```

## ファイル構成

```
hida_explorer/
├── test_5rooms_ltm.py    # 3部屋LTM/STMテスト（メイン）
├── test_moving_world.py  # 動く世界テスト（単一部屋）
├── hida.py               # HIDAエージェント（LTM/STM付き）
├── world.py              # 世界（壁が動く）
├── narrator.py           # 予測誤差の言語化
└── README.md
```

## 実行

```bash
# 3部屋LTM/STMテスト
python test_5rooms_ltm.py

# 動く世界テスト（単一部屋）
python test_moving_world.py
```

## 注意

- 5部屋のテストは未実装（3部屋でコンセプト証明済み）
- 部屋が増えても同じ仕組みで動くはず

## 核心

```
LTM = 過去の経験の保存
STM = 今の作業用メモリ

予測誤差 = LTMから読んだ予測 vs 現実

部屋を移動 → LTM/STM切り替え
記憶と違う → 予測誤差 → STM更新 → LTMに反映
```

## ライセンス

MIT License
