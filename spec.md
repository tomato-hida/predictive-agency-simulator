# 5層意識モデル - AI向け実装仕様書

このドキュメントは、AIがこの意識モデルのコードを書くために必要な情報をまとめたものです。

---

## 1. モデルの目的

「意識とは何か」を計算可能な形で実装し、シミュレーションで検証する。

**核心の主張：**
- 意識は「予測誤差が生存に関わるとき、全層を同期させて対処する処理モード」
- 意識は連続的ではなく、間欠的（ON/OFF）
- 「自己」は最初から存在せず、経験の蓄積で形成される

---

## 2. 5層アーキテクチャ

```
        ┌─────────────────────┐
        │  第5層: 意識        │ ← 全層同期モード
        │  (Consciousness)    │
        └─────────┬───────────┘
                  │
    ┌─────────────┼─────────────┐
    │             │             │
    ▼             ▼             ▼
┌───────┐   ┌───────────┐   ┌───────┐
│ 第2層 │◄─►│   第3層   │◄─►│ 第4層 │
│クオリア│   │  構造化   │   │ 記憶  │
│       │   │(予測符号化)│   │       │
└───┬───┘   └─────┬─────┘   └───┬───┘
    │             │             │
    └─────────────┼─────────────┘
                  │
        ┌─────────┴───────────┐
        │  第1層: 身体        │ ← センサー入力
        │  (Body)             │
        └─────────────────────┘
```

**重要：層の番号は説明の順番であり、処理の順番ではない。2-4層は相互ネットワーク。**

---

## 3. 各層の定義

### 第1層：身体層 (Body Layer)
- **役割：** 外部環境からの信号を受け取り、電気信号に変換
- **入力：** センサーデータ（視覚、聴覚、触覚など）
- **出力：** 正規化された信号値
- **実装：** `stimulus` として文字列 or 数値で表現

### 第2層：クオリア層 (Qualia Layer)
- **役割：** 信号を「感じ」に変換。即応的な記憶（RAM的）
- **入力：** 第1層からの信号
- **出力：** クオリア値（-1.0〜+1.0、負=不快、正=快）
- **特徴：** 概念を経由せず身体を動かせる（蛇→飛びのく）
- **実装：** `qualia_values = {'pain': -0.9, 'warm': +0.3, ...}`

### 第3層：構造化層 (Structuring Layer)
- **役割：** パターン認識、予測、予測誤差の計算
- **入力：** 第2層からのクオリア、第4層からの記憶
- **出力：** 予測誤差 (prediction_error)
- **計算：** 「予測」と「実際」のズレを数値化
- **実装：** 
```python
if predicted == actual:
    prediction_error = 0.0
else:
    prediction_error = 1.0  # または連続値
```

### 第4層：記憶層 (Memory Layer)
- **役割：** 長期記憶の保存と照合（SSD的）
- **入力：** 経験（stimulus, qualia, 結果）
- **出力：** 過去のパターン、自己の履歴
- **特徴：** self_strengthの基盤
- **実装：** `memory = []` にappendしていく

### 第5層：意識層 (Consciousness Layer)
- **役割：** 全層を強制同期させる処理モード
- **入力：** sync_score, self_strength
- **出力：** is_conscious (True/False)
- **発動条件：** 両方が閾値を超えたとき
- **実装：**
```python
is_conscious = (sync_score >= THRESHOLD and self_strength >= THRESHOLD)
```

---

## 4. 主要変数の定義

### THRESHOLD（閾値）
- **値：** 0.3
- **意味：** 意識が発動する最低ライン
- **発見：** 環境を変えても0.3近辺で安定

### self_strength（自己強度）
- **範囲：** 0.0〜1.0
- **初期値：** 0.0
- **成長条件：** パターンの繰り返しを認識したとき
- **計算例：**
```python
# 直近の記憶でパターン一致をカウント
matches = count_pattern_matches(memory)
self_strength += 0.001 * matches
self_strength = min(self_strength, 1.0)
```

### prediction_error（予測誤差）
- **範囲：** 0.0〜1.0
- **意味：** 予測と現実のズレの大きさ
- **計算：** 予測と実際の入力を比較

### sync_score（同期スコア）
- **範囲：** 0.0〜1.0
- **意味：** 全層がどれだけ同期しているか
- **現在の実装（シンプル版）：**
```python
sync_score = prediction_error * 0.8 + random.uniform(0, 0.2)
```
- **将来の拡張案：** docs/theory/sync-formula-gpt.md 参照

---

## 5. 意識判定ロジック

```python
def check_consciousness(self):
    # 両方が閾値を超えたら意識ON
    self.is_conscious = (
        self.sync_score >= self.THRESHOLD and 
        self.self_strength >= self.THRESHOLD
    )
```

**ポイント：**
- self_strengthが低い（自己未形成）→ 意識にならない
- sync_scoreが低い（予測誤差小）→ 意識不要（自動処理でOK）
- 両方高い → 意識ON（全層で対処が必要）

---

## 6. DNA初期値について

**重要な発見：初期値0は生物学的に不可能**

生物はDNAに初期感度が刻まれている。
```python
dna = {
    'pain': 1.0,      # 普通
    'warm': 1.0,
    'sweet': 1.0,
    'pleasure': 1.0
}
```

**極端な値の効果：**
- `dna_pain = 100` → 痛みと快感が混合（自傷、SM、激辛好き）
- これはバグではなく、実際にそういう人がいる

---

## 7. 各Phaseの目的

| Phase | 目的 | 期待する結果 |
|-------|------|-------------|
| 1 | 最小実装 | 100行で意識がON/OFFする |
| 2 | クオリア拡張 | 54種でも閾値0.3が維持される |
| 3 | DNA実験 | 極端な初期値で異常行動が創発 |
| 4 | 記憶と自己 | 記憶なしだとself_strengthが育たない |
| 5 | 環境比較 | 集中環境70%、混乱環境で低下 |

---

## 8. 検証すべき予測

理論から導かれる予測（コードで検証可能）：

1. ✅ 意識は閾値0.3で発動する
2. ✅ 記憶がないと自己は形成されない
3. ✅ 意識は100%にならない（70%で頭打ち）
4. ✅ マルチタスクで自己が弱まる
5. ✅ DNA極端値で痛み+快感の混合
6. □ 言語獲得のタイミング（Phase未実装）
7. □ 予測誤差0.95超で気絶（Phase未実装）
8. □ 複数エージェント間の相互理解（Phase未実装）

---

## 9. 拡張のためのヒント

### Phase 6以降に使える概念

**行動層の追加：**
- 予測誤差を減らすために「行動」する
- Active Inference（能動的推論）

**時間スケール：**
- 短期予測と長期予測の階層化

**複数エージェント：**
- NPC同士の相互作用
- コミュニケーションの創発

**より正確な同期計算：**
- GPT提案の式（sync-formula-gpt.md参照）
- PLV、相互情報量、コサイン類似度

---

## 10. コードを書くAIへの注意

1. **デジタルペット化を避ける**
   - 「意識なら〇〇する」と直接書かない
   - メカニズム（予測誤差、同期）を書く
   - 結果として振る舞いが創発するようにする

2. **予想外の結果を大切にする**
   - 「バグかも？」と思ったら人間に確認
   - 実際の人間の経験と照合する

3. **シンプルに始める**
   - 複雑な式より、動くコードを先に
   - 検証してから拡張する

---

## 参照ファイル

- `docs/theory/sync-formula-gpt.md` - 同期計算の詳細式（未実装）
- `code/phase1_minimal.py` - 最小実装
- `code/phase5_consciousness.py` - 現在の最新実装

---

**作成：とまと（トマト農家）+ Claude（Anthropic）**
**2025年11月**
